# æ´»åŠ¨åˆ—è¡¨æŒ‰é’®çŠ¶æ€ä¼˜åŒ–æ–‡æ¡£

## ğŸ“‹ ä¼˜åŒ–æ¦‚è¿°

**å®ç°æ—¥æœŸ**: 2025-11-16
**éœ€æ±‚æ¥æº**: ç”¨æˆ·åé¦ˆ

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

è§£å†³æ´»åŠ¨åˆ—è¡¨é¡µé¢æŒ‰é’®çŠ¶æ€ä¸æ¸…æ™°çš„é—®é¢˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼š
1. æ ¹æ®ç”¨æˆ·çš„æŠ¥åçŠ¶æ€æ˜¾ç¤ºä¸åŒçš„æŒ‰é’®
2. åŒºåˆ†å·²ç»“æŸã€å·²æ»¡ã€å·²æˆªæ­¢ç­‰ä¸å¯æ“ä½œçš„æ´»åŠ¨
3. æä¾›æ¸…æ™°çš„è§†è§‰åé¦ˆå’Œæ“ä½œå¼•å¯¼

## ğŸ’¡ é—®é¢˜åˆ†æ

### ä¼˜åŒ–å‰çš„é—®é¢˜

1. **æ‰€æœ‰æ´»åŠ¨éƒ½æ˜¾ç¤º"ç«‹å³æŠ¥å"æŒ‰é’®**
   - ç”¨æˆ·å·²æŠ¥åçš„æ´»åŠ¨ä»æ˜¾ç¤º"ç«‹å³æŠ¥å"
   - å·²ç»“æŸçš„æ´»åŠ¨ä»å¯ç‚¹å‡»æŠ¥å
   - æŠ¥åå·²æ»¡çš„æ´»åŠ¨ä»æ˜¾ç¤ºå¯ä»¥æŠ¥å

2. **ç”¨æˆ·ä½“éªŒæ··ä¹±**
   - æ— æ³•å¿«é€Ÿè¯†åˆ«å“ªäº›æ´»åŠ¨å·²æŠ¥å
   - ç‚¹å‡»åæ‰å‘ç°æ— æ³•æŠ¥åï¼ˆå·²æ»¡/å·²æˆªæ­¢ï¼‰
   - å·²ç»“æŸçš„æ´»åŠ¨ä¸åº”è¯¥æœ‰æŠ¥åå…¥å£

### ç”¨æˆ·éœ€æ±‚

> "é’ˆå¯¹æˆ‘è¿˜æœªæŠ¥åçš„æ´»åŠ¨å¯ä»¥å±•ç¤º'ç«‹å³æŠ¥å'ï¼Œä½†æ˜¯é’ˆå¯¹æˆ‘å·²æŠ¥åçš„æ´»åŠ¨ï¼Œå°±ä¸è¦å±•ç¤º'ç«‹å³æŠ¥å'æŒ‰é’®äº†ï¼Œæˆ–è€…éšè—æˆ–è€…ç°æ˜¾æˆ–è€…æ”¹ä¸º'å–æ¶ˆæŠ¥å'ã€‚å¦å¤–ï¼Œé’ˆå¯¹å·²ç»“æŸçš„æ´»åŠ¨ï¼Œåªèƒ½æ“ä½œæŸ¥çœ‹è¯¦æƒ…ï¼Œå…¶ä»–æŒ‰é’®å»ºè®®éšè—æˆ–ç°æ˜¾ã€‚"

## âœ¨ ä¼˜åŒ–æ–¹æ¡ˆ

### æŒ‰é’®çŠ¶æ€è®¾è®¡ï¼ˆä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼‰

| ä¼˜å…ˆçº§ | æ¡ä»¶ | æŒ‰é’®æ–‡æœ¬ | æŒ‰é’®æ ·å¼ | ç‚¹å‡»è¡Œä¸º | è¯´æ˜ |
|--------|------|---------|---------|---------|------|
| 1 | æ´»åŠ¨å·²ç»“æŸ | - | éšè— | - | åªæ˜¾ç¤º"æŸ¥çœ‹è¯¦æƒ…" |
| 2 | æŠ¥åå·²æ»¡ | å·²æ»¡ | ç°è‰²ç¦ç”¨ | æ—  | æœªæŠ¥åç”¨æˆ·ä¸å¯æŠ¥å |
| 3 | æŠ¥åæˆªæ­¢ | å·²æˆªæ­¢ | ç°è‰²ç¦ç”¨ | æ—  | è¶…è¿‡æŠ¥åæˆªæ­¢æ—¶é—´ |
| 4 | å¾…å®¡æ ¸ | å¾…å®¡æ ¸ | é»„è‰² | æŸ¥çœ‹è¯¦æƒ… | å·²æŠ¥åç­‰å¾…å®¡æ ¸ |
| 5 | å®¡æ ¸é€šè¿‡ | å·²æŠ¥å | ç»¿è‰² | æŸ¥çœ‹è¯¦æƒ… | æŠ¥åæˆåŠŸ |
| 6 | è¢«æ‹’ç» | å·²æ‹’ç» | çº¢è‰² | é‡æ–°æŠ¥å | å¯å°è¯•é‡æ–°æŠ¥å |
| 7 | å¯æŠ¥å | ç«‹å³æŠ¥å | è“è‰² | æŠ¥å | æœªæŠ¥åä¸”å¯æŠ¥å |

### æŒ‰é’®æ ·å¼é…è‰²

```css
/* ç«‹å³æŠ¥å - è“è‰²æ¸å˜ */
.btn--primary {
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: #ffffff;
}

/* å·²æŠ¥å - ç»¿è‰²æ¸å˜ */
.btn--registered {
  background: linear-gradient(135deg, #10b981, #059669);
  color: #ffffff;
}

/* å¾…å®¡æ ¸ - é»„è‰²æ¸å˜ */
.btn--pending {
  background: linear-gradient(135deg, #f59e0b, #d97706);
  color: #ffffff;
}

/* å·²æ‹’ç» - çº¢è‰²æ¸å˜ */
.btn--rejected {
  background: linear-gradient(135deg, #ef4444, #dc2626);
  color: #ffffff;
}

/* ç¦ç”¨çŠ¶æ€ - ç°è‰² */
.btn--disabled {
  background: #e5e7eb;
  color: #9ca3af;
  border: 1rpx solid #d1d5db;
}
```

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### 1. æ•°æ®å¤„ç†é€»è¾‘ï¼ˆlist.jsï¼‰

#### 1.1 enrichActivities æ•°æ®å¢å¼º

```javascript
const enrichedActivities = activities.map(activity => {
  // æŸ¥æ‰¾è¯¥æ´»åŠ¨çš„æŠ¥åè®°å½•
  const myReg = myRegistrations.find(r => r.activityId === activity.id);

  // ç¿»è¯‘æ´»åŠ¨çŠ¶æ€ä¸ºä¸­æ–‡
  const translatedStatus = translateActivityStatus(activity.status);

  // è®¡ç®—æŒ‰é’®çŠ¶æ€
  const buttonState = this.calculateButtonState(activity, myReg, translatedStatus);

  return {
    ...activity,
    status: translatedStatus,
    isRegistered: !!myReg && myReg.status !== 'cancelled' && myReg.status !== 'rejected',
    registrationStatus: myReg ? myReg.status : null,
    ...buttonState
  };
});
```

#### 1.2 calculateButtonState æŒ‰é’®çŠ¶æ€è®¡ç®—

```javascript
calculateButtonState(activity, myReg, translatedStatus) {
  const now = new Date();
  const registerDeadline = new Date(activity.registerDeadline);
  const isFull = activity.joined >= activity.total;
  const isDeadlinePassed = now > registerDeadline;

  // ä¼˜å…ˆçº§1: å·²ç»“æŸçš„æ´»åŠ¨
  if (translatedStatus === 'å·²ç»“æŸ') {
    return {
      showRegisterButton: false,
      buttonText: '',
      buttonStyle: '',
      buttonDisabled: true,
      buttonAction: 'none'
    };
  }

  // ä¼˜å…ˆçº§2: æŠ¥åå·²æ»¡
  if (isFull && (!myReg || myReg.status === 'rejected' || myReg.status === 'cancelled')) {
    return {
      showRegisterButton: true,
      buttonText: 'å·²æ»¡',
      buttonStyle: 'btn--disabled',
      buttonDisabled: true,
      buttonAction: 'none'
    };
  }

  // ä¼˜å…ˆçº§3: æŠ¥åæˆªæ­¢
  if (isDeadlinePassed && (!myReg || myReg.status === 'rejected' || myReg.status === 'cancelled')) {
    return {
      showRegisterButton: true,
      buttonText: 'å·²æˆªæ­¢',
      buttonStyle: 'btn--disabled',
      buttonDisabled: true,
      buttonAction: 'none'
    };
  }

  // ä¼˜å…ˆçº§4-6: å·²æŠ¥åçš„å„ç§çŠ¶æ€
  if (myReg) {
    switch (myReg.status) {
      case 'pending':
        return {
          showRegisterButton: true,
          buttonText: 'å¾…å®¡æ ¸',
          buttonStyle: 'btn--pending',
          buttonDisabled: false,
          buttonAction: 'viewDetail'
        };
      case 'approved':
        return {
          showRegisterButton: true,
          buttonText: 'å·²æŠ¥å',
          buttonStyle: 'btn--registered',
          buttonDisabled: false,
          buttonAction: 'viewDetail'
        };
      case 'rejected':
        return {
          showRegisterButton: true,
          buttonText: 'å·²æ‹’ç»',
          buttonStyle: 'btn--rejected',
          buttonDisabled: false,
          buttonAction: 'reRegister'
        };
    }
  }

  // ä¼˜å…ˆçº§7: å¯ä»¥æŠ¥å
  return {
    showRegisterButton: true,
    buttonText: 'ç«‹å³æŠ¥å',
    buttonStyle: 'btn--primary',
    buttonDisabled: false,
    buttonAction: 'register'
  };
}
```

#### 1.3 goRegister ç‚¹å‡»äº‹ä»¶å¤„ç†

```javascript
goRegister(e) {
  const id = e.currentTarget.dataset.id;
  const action = e.currentTarget.dataset.action;

  if (action === 'viewDetail') {
    // å·²æŠ¥åçš„æ´»åŠ¨ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…
    wx.navigateTo({ url: `/pages/activities/detail?id=${id}` });
  } else if (action === 'register' || action === 'reRegister') {
    // ç«‹å³æŠ¥åæˆ–é‡æ–°æŠ¥å
    wx.navigateTo({ url: `/pages/registration/index?id=${id}` });
  } else if (action === 'none') {
    // ä¸å¯ç‚¹å‡»çš„çŠ¶æ€
    return;
  }
}
```

### 2. è§†å›¾å±‚å®ç°ï¼ˆlist.wxmlï¼‰

```xml
<view class="row-between mb-12">
  <text class="text-sm text-gray-600">å·²æŠ¥ {{item.joined}} / {{item.total}}</text>
  <view class="row gap-12">
    <!-- æŠ¥åæŒ‰é’® - æ ¹æ®çŠ¶æ€åŠ¨æ€æ˜¾ç¤º -->
    <view
      wx:if="{{item.showRegisterButton}}"
      class="btn {{item.buttonStyle}} btn--small"
      catchtap="{{item.buttonDisabled ? '' : 'goRegister'}}"
      data-id="{{item.id}}"
      data-action="{{item.buttonAction}}">
      {{item.buttonText}}
    </view>
    <!-- æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® -->
    <view class="btn btn--secondary btn--small" catchtap="goDetail" data-id="{{item.id}}">
      æŸ¥çœ‹è¯¦æƒ…
    </view>
  </view>
</view>
```

**å…³é”®ç‚¹**:
- `wx:if="{{item.showRegisterButton}}"` - å·²ç»“æŸæ´»åŠ¨éšè—æŠ¥åæŒ‰é’®
- `catchtap="{{item.buttonDisabled ? '' : 'goRegister'}}"` - ç¦ç”¨çŠ¶æ€ä¸è§¦å‘ç‚¹å‡»
- `data-action="{{item.buttonAction}}"` - ä¼ é€’ç‚¹å‡»è¡Œä¸ºç±»å‹

### 3. æ ·å¼å®ç°ï¼ˆlist.wxssï¼‰

```css
/* å·²æŠ¥åçŠ¶æ€ - ç»¿è‰² */
.btn--registered {
  background: linear-gradient(135deg, #10b981, #059669);
  color: #ffffff;
  box-shadow: 0 2rpx 8rpx rgba(16, 185, 129, 0.25);
}

/* å¾…å®¡æ ¸çŠ¶æ€ - é»„è‰² */
.btn--pending {
  background: linear-gradient(135deg, #f59e0b, #d97706);
  color: #ffffff;
  box-shadow: 0 2rpx 8rpx rgba(245, 158, 11, 0.25);
}

/* å·²æ‹’ç»çŠ¶æ€ - çº¢è‰² */
.btn--rejected {
  background: linear-gradient(135deg, #ef4444, #dc2626);
  color: #ffffff;
  box-shadow: 0 2rpx 8rpx rgba(239, 68, 68, 0.25);
}

/* ç¦ç”¨çŠ¶æ€ - ç°è‰² */
.btn--disabled {
  background: #e5e7eb;
  color: #9ca3af;
  border: 1rpx solid #d1d5db;
  box-shadow: none;
  cursor: not-allowed;
}

.btn--disabled:active {
  transform: none;
  background: #e5e7eb;
}
```

## ğŸ“Š ç”¨æˆ·ä½“éªŒæå‡

### ä¼˜åŒ–å‰ vs ä¼˜åŒ–å

| åœºæ™¯ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹è¿› |
|------|--------|--------|------|
| å·²æŠ¥åæ´»åŠ¨ | æ˜¾ç¤º"ç«‹å³æŠ¥å" | æ˜¾ç¤º"å·²æŠ¥å"ï¼ˆç»¿è‰²ï¼‰ | âœ… ä¸€ç›®äº†ç„¶ |
| å¾…å®¡æ ¸æ´»åŠ¨ | æ˜¾ç¤º"ç«‹å³æŠ¥å" | æ˜¾ç¤º"å¾…å®¡æ ¸"ï¼ˆé»„è‰²ï¼‰ | âœ… çŠ¶æ€æ¸…æ™° |
| è¢«æ‹’ç»æ´»åŠ¨ | æ˜¾ç¤º"ç«‹å³æŠ¥å" | æ˜¾ç¤º"å·²æ‹’ç»"ï¼ˆçº¢è‰²ï¼‰ | âœ… å¯é‡æ–°æŠ¥å |
| å·²ç»“æŸæ´»åŠ¨ | æ˜¾ç¤º"ç«‹å³æŠ¥å" | éšè—æŠ¥åæŒ‰é’® | âœ… é¿å…è¯¯æ“ä½œ |
| æŠ¥åå·²æ»¡ | å¯ç‚¹å‡»æŠ¥å | æ˜¾ç¤º"å·²æ»¡"ï¼ˆç°è‰²ï¼‰ | âœ… æå‰å‘ŠçŸ¥ |
| æŠ¥åæˆªæ­¢ | å¯ç‚¹å‡»æŠ¥å | æ˜¾ç¤º"å·²æˆªæ­¢"ï¼ˆç°è‰²ï¼‰ | âœ… æå‰å‘ŠçŸ¥ |

### äº¤äº’æµç¨‹ä¼˜åŒ–

#### åœºæ™¯1: ç”¨æˆ·æµè§ˆæ´»åŠ¨åˆ—è¡¨

**ä¼˜åŒ–å‰**:
1. çœ‹åˆ°æ‰€æœ‰æ´»åŠ¨éƒ½æ˜¾ç¤º"ç«‹å³æŠ¥å"
2. æ— æ³•å¿«é€Ÿè¯†åˆ«å·²æŠ¥åæ´»åŠ¨
3. ç‚¹å‡»åæ‰å‘ç°å·²æŠ¥åæˆ–æ— æ³•æŠ¥å

**ä¼˜åŒ–å**:
1. å·²æŠ¥åæ´»åŠ¨æ˜¾ç¤ºç»¿è‰²"å·²æŠ¥å"æŒ‰é’®
2. ä¸€çœ¼è¯†åˆ«æŠ¥åçŠ¶æ€
3. ç‚¹å‡»"å·²æŠ¥å"ç›´æ¥æŸ¥çœ‹è¯¦æƒ…

#### åœºæ™¯2: ç”¨æˆ·æŸ¥æ‰¾å¯æŠ¥åæ´»åŠ¨

**ä¼˜åŒ–å‰**:
1. ç‚¹å‡»"ç«‹å³æŠ¥å"
2. ç³»ç»Ÿæç¤º"æŠ¥åå·²æ»¡"æˆ–"æŠ¥åå·²æˆªæ­¢"
3. è¿”å›åˆ—è¡¨ç»§ç»­å¯»æ‰¾

**ä¼˜åŒ–å**:
1. ç›´æ¥çœ‹åˆ°ç°è‰²"å·²æ»¡"æˆ–"å·²æˆªæ­¢"æŒ‰é’®
2. è·³è¿‡ä¸å¯æŠ¥åæ´»åŠ¨
3. å¿«é€Ÿæ‰¾åˆ°å¯æŠ¥åæ´»åŠ¨

#### åœºæ™¯3: æŠ¥åè¢«æ‹’ç»çš„ç”¨æˆ·

**ä¼˜åŒ–å‰**:
1. ä¸çŸ¥é“æŠ¥åçŠ¶æ€
2. å¯èƒ½é‡å¤ç‚¹å‡»"ç«‹å³æŠ¥å"
3. æ— æ˜ç¡®å¼•å¯¼

**ä¼˜åŒ–å**:
1. æ˜¾ç¤ºçº¢è‰²"å·²æ‹’ç»"æŒ‰é’®
2. ç‚¹å‡»å¯é‡æ–°æŠ¥å
3. æœ‰æœºä¼šä¿®æ”¹èµ„æ–™é‡è¯•

## ğŸ§ª æµ‹è¯•åœºæ™¯

### æµ‹è¯•åœºæ™¯1: æœªæŠ¥åä¸”å¯æŠ¥å

**å‰ç½®æ¡ä»¶**:
- ç”¨æˆ·æœªæŠ¥åè¯¥æ´»åŠ¨
- æ´»åŠ¨æœªç»“æŸã€æœªæˆªæ­¢ã€æœªæ»¡

**é¢„æœŸç»“æœ**:
- âœ… æ˜¾ç¤ºè“è‰²"ç«‹å³æŠ¥å"æŒ‰é’®
- âœ… ç‚¹å‡»è·³è½¬åˆ°æŠ¥åé¡µé¢

### æµ‹è¯•åœºæ™¯2: å·²æŠ¥åï¼ˆå®¡æ ¸é€šè¿‡ï¼‰

**å‰ç½®æ¡ä»¶**:
- ç”¨æˆ·å·²æŠ¥åä¸”status='approved'

**é¢„æœŸç»“æœ**:
- âœ… æ˜¾ç¤ºç»¿è‰²"å·²æŠ¥å"æŒ‰é’®
- âœ… ç‚¹å‡»è·³è½¬åˆ°æ´»åŠ¨è¯¦æƒ…é¡µ

### æµ‹è¯•åœºæ™¯3: å¾…å®¡æ ¸

**å‰ç½®æ¡ä»¶**:
- ç”¨æˆ·å·²æŠ¥åä½†status='pending'

**é¢„æœŸç»“æœ**:
- âœ… æ˜¾ç¤ºé»„è‰²"å¾…å®¡æ ¸"æŒ‰é’®
- âœ… ç‚¹å‡»è·³è½¬åˆ°æ´»åŠ¨è¯¦æƒ…é¡µ

### æµ‹è¯•åœºæ™¯4: æŠ¥åè¢«æ‹’ç»

**å‰ç½®æ¡ä»¶**:
- ç”¨æˆ·æŠ¥åè¢«æ‹’ç»status='rejected'

**é¢„æœŸç»“æœ**:
- âœ… æ˜¾ç¤ºçº¢è‰²"å·²æ‹’ç»"æŒ‰é’®
- âœ… ç‚¹å‡»è·³è½¬åˆ°æŠ¥åé¡µé¢ï¼ˆé‡æ–°æŠ¥åï¼‰

### æµ‹è¯•åœºæ™¯5: å·²ç»“æŸæ´»åŠ¨

**å‰ç½®æ¡ä»¶**:
- æ´»åŠ¨çŠ¶æ€ä¸º"å·²ç»“æŸ"

**é¢„æœŸç»“æœ**:
- âœ… éšè—æŠ¥åæŒ‰é’®
- âœ… åªæ˜¾ç¤º"æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®

### æµ‹è¯•åœºæ™¯6: æŠ¥åå·²æ»¡

**å‰ç½®æ¡ä»¶**:
- joined >= total
- ç”¨æˆ·æœªæŠ¥å

**é¢„æœŸç»“æœ**:
- âœ… æ˜¾ç¤ºç°è‰²"å·²æ»¡"æŒ‰é’®
- âœ… æŒ‰é’®ä¸å¯ç‚¹å‡»

### æµ‹è¯•åœºæ™¯7: æŠ¥åæˆªæ­¢

**å‰ç½®æ¡ä»¶**:
- å½“å‰æ—¶é—´ > registerDeadline
- ç”¨æˆ·æœªæŠ¥å

**é¢„æœŸç»“æœ**:
- âœ… æ˜¾ç¤ºç°è‰²"å·²æˆªæ­¢"æŒ‰é’®
- âœ… æŒ‰é’®ä¸å¯ç‚¹å‡»

## ğŸ“ ç›¸å…³æ–‡ä»¶

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | ä¿®æ”¹å†…å®¹ | è¡Œæ•° |
|---------|---------|------|
| `pages/activities/list.js` | æ·»åŠ æŒ‰é’®çŠ¶æ€è®¡ç®—é€»è¾‘ | 64-249 |
| `pages/activities/list.wxml` | ä¿®æ”¹æŒ‰é’®æ¸²æŸ“é€»è¾‘ | 43-58 |
| `pages/activities/list.wxss` | æ·»åŠ æ–°æŒ‰é’®æ ·å¼ | 127-165 |

### å¾…ä¼˜åŒ–çš„æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | ä¼˜åŒ–å†…å®¹ |
|---------|---------|
| `pages/home/index.js` | é¦–é¡µæ´»åŠ¨å¡ç‰‡ä¹Ÿéœ€è¦åŒæ ·çš„æŒ‰é’®çŠ¶æ€é€»è¾‘ |
| `pages/home/index.wxml` | é¦–é¡µæ´»åŠ¨å¡ç‰‡æŒ‰é’®æ¸²æŸ“ |
| `pages/home/index.wxss` | é¦–é¡µæ´»åŠ¨å¡ç‰‡æŒ‰é’®æ ·å¼ |

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

### 1. ç»Ÿä¸€æ´»åŠ¨å¡ç‰‡ç»„ä»¶

å°†æ´»åŠ¨å¡ç‰‡æŠ½å–ä¸ºé€šç”¨ç»„ä»¶ï¼Œé¿å…ä»£ç é‡å¤ï¼š

```javascript
// components/activity-card/index.js
Component({
  properties: {
    activity: Object,
    myRegistration: Object
  },
  methods: {
    calculateButtonState() {
      // ç»Ÿä¸€çš„æŒ‰é’®çŠ¶æ€è®¡ç®—é€»è¾‘
    },
    handleClick() {
      // ç»Ÿä¸€çš„ç‚¹å‡»å¤„ç†
    }
  }
});
```

**ä½¿ç”¨åœºæ™¯**:
- é¦–é¡µæ´»åŠ¨æ¨è
- æ´»åŠ¨åˆ—è¡¨é¡µ
- æˆ‘çš„æ´»åŠ¨é¡µ
- æ”¶è—æ´»åŠ¨é¡µ

### 2. æ·»åŠ å–æ¶ˆæŠ¥ååŠŸèƒ½

ä¸º"å·²æŠ¥å"çŠ¶æ€æ·»åŠ å–æ¶ˆæŠ¥åé€‰é¡¹ï¼š

```javascript
// é•¿æŒ‰"å·²æŠ¥å"æŒ‰é’®æ˜¾ç¤ºèœå•
onRegisterButtonLongPress(e) {
  const { id, registrationStatus } = e.currentTarget.dataset;

  if (registrationStatus === 'approved' || registrationStatus === 'pending') {
    wx.showActionSheet({
      itemList: ['æŸ¥çœ‹è¯¦æƒ…', 'å–æ¶ˆæŠ¥å'],
      success: (res) => {
        if (res.tapIndex === 0) {
          // æŸ¥çœ‹è¯¦æƒ…
          this.goDetail(e);
        } else if (res.tapIndex === 1) {
          // å–æ¶ˆæŠ¥å
          this.cancelRegistration(id);
        }
      }
    });
  }
}
```

### 3. æ™ºèƒ½ç­›é€‰åŠŸèƒ½

æ·»åŠ "æˆ‘çš„æŠ¥å"ç­›é€‰é¡¹ï¼Œå¿«é€Ÿæ‰¾åˆ°å·²æŠ¥åæ´»åŠ¨ï¼š

```javascript
const filters = [
  { key: 'all', name: 'å…¨éƒ¨' },
  { key: 'my-registered', name: 'æˆ‘çš„æŠ¥å' },  // æ–°å¢
  { key: 'available', name: 'å¯æŠ¥å' },        // æ–°å¢
  { key: 'status:è¿›è¡Œä¸­', name: 'è¿›è¡Œä¸­' },
  { key: 'status:å³å°†å¼€å§‹', name: 'å³å°†å¼€å§‹' },
  { key: 'status:å·²ç»“æŸ', name: 'å·²ç»“æŸ' }
];
```

### 4. æŠ¥åè¿›åº¦å¯è§†åŒ–

åœ¨"å·²æ»¡"ã€"å·²æˆªæ­¢"ç­‰æŒ‰é’®ä¸Šæ˜¾ç¤ºè¿›åº¦ä¿¡æ¯ï¼š

```xml
<view class="btn btn--disabled btn--small">
  <text>å·²æ»¡ {{item.joined}}/{{item.total}}</text>
  <view class="progress-bar">
    <view class="progress-fill" style="width: 100%"></view>
  </view>
</view>
```

### 5. æé†’åŠŸèƒ½

ä¸º"å¾…å®¡æ ¸"çŠ¶æ€æ·»åŠ æ¶ˆæ¯æé†’ï¼š

```javascript
// æŠ¥åå®¡æ ¸é€šè¿‡åæ¨é€é€šçŸ¥
if (newStatus === 'approved' && oldStatus === 'pending') {
  wx.showToast({
    title: 'æŠ¥åå®¡æ ¸é€šè¿‡',
    icon: 'success'
  });

  // å‘é€æ¨¡æ¿æ¶ˆæ¯
  sendTemplateMessage(userId, activityId, 'approval_success');
}
```

## ğŸ¨ è§†è§‰æ•ˆæœå±•ç¤º

### æŒ‰é’®çŠ¶æ€è§†è§‰å¯¹æ¯”

```
æœªæŠ¥åï¼ˆè“è‰²ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç«‹å³æŠ¥å    â”‚  â† æ¸å˜è“è‰²ï¼Œå¯ç‚¹å‡»
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·²æŠ¥åï¼ˆç»¿è‰²ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·²æŠ¥å      â”‚  â† æ¸å˜ç»¿è‰²ï¼ŒæŸ¥çœ‹è¯¦æƒ…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¾…å®¡æ ¸ï¼ˆé»„è‰²ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¾…å®¡æ ¸      â”‚  â† æ¸å˜é»„è‰²ï¼ŒæŸ¥çœ‹è¯¦æƒ…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·²æ‹’ç»ï¼ˆçº¢è‰²ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·²æ‹’ç»      â”‚  â† æ¸å˜çº¢è‰²ï¼Œé‡æ–°æŠ¥å
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·²æ»¡/å·²æˆªæ­¢ï¼ˆç°è‰²ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·²æ»¡        â”‚  â† ç°è‰²ï¼Œä¸å¯ç‚¹å‡»
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·²ç»“æŸ
              â† éšè—æŠ¥åæŒ‰é’®
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åŒæ­¥**: ç¡®ä¿ `registrationAPI.getMyRegistrations()` è¿”å›å®Œæ•´çš„æŠ¥åè®°å½•
2. **æ—¶åŒºå¤„ç†**: `registerDeadline` çš„æ—¶é—´åˆ¤æ–­éœ€è€ƒè™‘æ—¶åŒºå·®å¼‚
3. **ç¼“å­˜æ›´æ–°**: æŠ¥å/å–æ¶ˆæŠ¥ååéœ€åˆ·æ–°æ´»åŠ¨åˆ—è¡¨
4. **é”™è¯¯å¤„ç†**: APIè¯·æ±‚å¤±è´¥æ—¶çš„é™çº§æ˜¾ç¤º
5. **æ€§èƒ½ä¼˜åŒ–**: å¤§é‡æ´»åŠ¨æ—¶çš„æŒ‰é’®çŠ¶æ€è®¡ç®—æ€§èƒ½

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¥æœŸ**: 2025-11-16
**ç»´æŠ¤äººå‘˜**: å¼€å‘å›¢é˜Ÿ
