<!-- pages/registration/index.wxml -->
<view class="registration-header">
  <text class="registration-title">{{detail.title}}</text>
</view>

<!-- æ´»åŠ¨ä¿¡æ¯å¡ç‰‡ -->
<view class="activity-info-section">
  <view class="activity-info-card">
    <!-- æ´»åŠ¨å°é¢å’ŒçŠ¶æ€ -->
    <view class="activity-cover banner--{{detail.banner}}">
      <view class="cover-badges">
        <view class="cover-badge cover-badge--status">{{detail.status}}</view>
        <view class="cover-badge cover-badge--type">{{detail.type}}</view>
      </view>
    </view>

    <!-- æ´»åŠ¨æè¿° -->
    <view class="activity-desc">
      <text class="desc-text">{{detail.desc}}</text>
    </view>

    <!-- å…³é”®ä¿¡æ¯ç½‘æ ¼ -->
    <view class="info-grid">
      <view class="info-grid-item">
        <view class="info-grid-icon info-grid-icon--time">
          <text class="icon-emoji">ğŸ•</text>
        </view>
        <view class="info-grid-content">
          <text class="info-grid-label">æ´»åŠ¨æ—¶é—´</text>
          <text class="info-grid-value">{{detail.timeRange}}</text>
          <text class="info-grid-sub">æˆªæ­¢ï¼š{{deadline}}</text>
        </view>
      </view>

      <view class="info-grid-item">
        <view class="info-grid-icon info-grid-icon--location">
          <text class="icon-emoji">ğŸ“</text>
        </view>
        <view class="info-grid-content">
          <text class="info-grid-label">æ´»åŠ¨åœ°ç‚¹</text>
          <text class="info-grid-value">{{detail.place}}</text>
          <text class="info-grid-sub">æå‰30åˆ†é’Ÿåˆ°è¾¾</text>
        </view>
      </view>

      <view class="info-grid-item">
        <view class="info-grid-icon info-grid-icon--people">
          <text class="icon-emoji">ğŸ‘¥</text>
        </view>
        <view class="info-grid-content">
          <text class="info-grid-label">å‚ä¸äººæ•°</text>
          <text class="info-grid-value">{{detail.joined}} / {{detail.total}} äºº</text>
          <view class="mini-progress">
            <view class="mini-progress-bar" style="width: {{progress}}%"></view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- æŠ¥åè¡¨å• -->
<view class="form-section">
  <view class="form-header">
    <text class="form-title">å¡«å†™æŠ¥åä¿¡æ¯</text>
    <text class="form-subtitle">è¯·å¦‚å®å¡«å†™ä»¥ä¸‹ä¿¡æ¯</text>
  </view>

  <view class="form-container">
    <!-- åŠ¨æ€å­—æ®µ -->
    <view class="form-group">
      <block wx:for="{{customFields}}" wx:key="id" wx:for-item="field">
        <view class="input-wrapper">
          <view class="input-label-row">
            <text class="input-label">{{field.label}}</text>
            <text wx:if="{{field.required}}" class="input-required">*</text>
          </view>
          <input
            class="input-field"
            type="{{field.id === 'mobile' ? 'number' : 'text'}}"
            placeholder="{{field.desc || 'è¯·è¾“å…¥' + field.label}}"
            bindinput="onInput"
            data-field="{{field.id}}"
            value="{{formData[field.id]}}"
          />
          <text wx:if="{{field.desc}}" class="field-hint" style="font-size: 22rpx; color: #9ca3af; margin-top: 8rpx; display: block;">{{field.desc}}</text>
        </view>
      </block>
    </view>

    <!-- è´¹ç”¨å’Œæç¤º -->
    <view class="info-cards">
      <!-- æŠ¥åè¦æ±‚ -->
      <view wx:if="{{detail.requirements}}" class="info-tip-card info-tip-card--orange">
        <text class="info-tip-title">âš ï¸ æŠ¥åè¦æ±‚</text>
        <text class="info-tip-text">{{detail.requirements}}</text>
      </view>

      <!-- è´¹ç”¨è¯´æ˜ -->
      <view class="info-tip-card info-tip-card--blue">
        <text class="info-tip-title">ğŸ’° è´¹ç”¨è¯´æ˜</text>
        <text class="info-tip-text">{{feeInfo}}</text>
      </view>

      <!-- æ¸©é¦¨æç¤º -->
      <view class="info-tip-card info-tip-card--gray">
        <text class="info-tip-title">ğŸ“Œ æ¸©é¦¨æç¤º</text>
        <view class="info-tip-list">
          <block wx:for="{{guidelines}}" wx:key="index" wx:for-item="tip">
            <text class="info-tip-item">â€¢ {{tip}}</text>
          </block>
        </view>
      </view>
    </view>

    <!-- åè®® -->
    <view class="agreement-box">
      <checkbox checked="{{agree}}" bindchange="toggleAgree" class="agreement-checkbox" />
      <text class="agreement-text">å·²é˜…è¯»å¹¶åŒæ„ã€Šæ´»åŠ¨æŠ¥ååè®®ã€‹å’Œã€Šéšç§æ”¿ç­–ã€‹</text>
    </view>
  </view>
</view>

<view class="section">
  <view class="card shadow-card participant-card">
    <view class="row-between mb-16">
      <text class="text-lg text-gray-800">æŠ¥ååˆ—è¡¨</text>
      <text class="text-sm text-gray-500">{{participants.length}} äººå·²æŠ¥å</text>
    </view>
    <view class="flex-col">
      <block wx:for="{{participants}}" wx:key="id" wx:for-item="item" wx:for-index="idx">
        <view class="participant-item">
          <view class="participant-avatar" style="background: {{item.bg}};">{{item.index}}</view>
          <view class="flex-col participant-info">
            <text class="text-md text-gray-800">{{item.name}}</text>
            <text class="text-xs text-gray-500">{{item.mobile}}</text>
          </view>
          <text class="text-xs text-gray-400">{{item.time}}</text>
        </view>
        <view wx:if="{{idx < participants.length - 1}}" class="list-divider"></view>
      </block>
    </view>
  </view>
</view>

<view class="bottom-space"></view>
<view class="fixed-footer">
  <button class="btn btn--secondary footer-btn" bindtap="cancel">è¿”å›</button>
  <button class="btn {{isRegistered ? 'btn--danger' : 'btn--primary'}} footer-btn" bindtap="{{isRegistered ? 'cancelRegistration' : 'submit'}}">{{isRegistered ? 'å–æ¶ˆæŠ¥å' : 'ç¡®è®¤æŠ¥å'}}</button>
</view>
