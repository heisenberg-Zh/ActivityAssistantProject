<!-- pages/profile/index.wxml -->
<view class="section">
  <view class="card shadow-card profile-card">
    <view class="row gap-16 profile-head">
      <view class="profile-avatar">{{user.initial}}</view>
      <view class="flex-col">
        <text class="text-xl text-gray-800">{{user.name}}</text>
        <text class="text-sm text-gray-500">{{user.role}}</text>
        <text class="text-xs text-gray-400">ID: {{user.id}}</text>
      </view>
    </view>
    <text class="profile-desc text-sm text-gray-600">{{user.tagline}}</text>
  </view>
</view>

<view class="section">
  <view class="card shadow-card stats-card">
    <text class="section-title">我的数据</text>
    <view class="stats-grid">
      <block wx:for="{{stats}}" wx:key="label" wx:for-item="item">
        <view class="stats-item">
          <view class="stats-icon" style="background: {{item.bg}}; color: {{item.color}};">{{item.icon}}</view>
          <text class="stats-value">{{item.value}}</text>
          <text class="stats-label">{{item.label}}</text>
        </view>
      </block>
    </view>
  </view>
</view>

<view class="section">
  <view class="card shadow-card menu-card">
    <view class="menu-list">
      <block wx:for="{{menuLinks}}" wx:key="key" wx:for-item="item">
        <view class="menu-item" bindtap="handleMenu" data-key="{{item.key}}">
          <view class="menu-icon" style="background: {{item.bg}}; color: {{item.color}};">{{item.icon}}</view>
          <text class="text-md text-gray-800">{{item.label}}</text>
          <text wx:if="{{item.badge}}" class="menu-badge">{{item.badge}}</text>
        </view>
      </block>
    </view>
  </view>
</view>

<view class="section">
  <view class="logout-btn" bindtap="logout">退出登录</view>
</view>

<!-- 帮助与反馈弹窗 -->
<view class="feedback-modal" wx:if="{{showFeedbackModal}}">
  <view class="feedback-mask" bindtap="closeFeedbackModal"></view>
  <view class="feedback-content">
    <view class="feedback-header">
      <text class="feedback-title">帮助与反馈</text>
      <view class="feedback-close" bindtap="closeFeedbackModal">✕</view>
    </view>

    <view class="feedback-body">
      <text class="feedback-hint">如需帮助或有意见和建议，欢迎反馈</text>
      <textarea
        class="feedback-textarea"
        placeholder="请输入您的反馈内容..."
        maxlength="1000"
        value="{{feedbackContent}}"
        bindinput="onFeedbackInput"
        auto-height
      />
      <text class="feedback-counter">{{feedbackCount}}/1000</text>
    </view>

    <view class="feedback-footer">
      <view class="feedback-btn feedback-btn--cancel" bindtap="closeFeedbackModal">取消</view>
      <view class="feedback-btn feedback-btn--submit" bindtap="submitFeedback">确定</view>
    </view>
  </view>
</view>

<view class="bottom-space"></view>