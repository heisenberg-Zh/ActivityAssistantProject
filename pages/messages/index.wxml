<!-- pages/messages/index.wxml -->

<!-- æ¸¸å®¢çŠ¶æ€æç¤º -->
<view wx:if="{{!isLoggedIn}}" class="guest-container">
  <view class="guest-content">
    <view class="guest-icon">ğŸ’¬</view>
    <text class="guest-title">æ¶ˆæ¯ä¸­å¿ƒ</text>
    <text class="guest-desc">ç™»å½•åæŸ¥çœ‹æ‚¨çš„æ¶ˆæ¯é€šçŸ¥</text>
    <view class="guest-features">
      <view class="guest-feature-item">
        <text class="guest-feature-icon">ğŸ“¢</text>
        <text class="guest-feature-text">æ¥æ”¶æ´»åŠ¨å‘å¸ƒé€šçŸ¥</text>
      </view>
      <view class="guest-feature-item">
        <text class="guest-feature-icon">ğŸ””</text>
        <text class="guest-feature-text">æŸ¥çœ‹æ´»åŠ¨æé†’</text>
      </view>
      <view class="guest-feature-item">
        <text class="guest-feature-icon">ğŸ“¬</text>
        <text class="guest-feature-text">ç®¡ç†æ¶ˆæ¯çŠ¶æ€</text>
      </view>
    </view>
    <view class="guest-login-btn" bindtap="goLogin">
      <text class="guest-login-icon">ğŸ”</text>
      <text class="guest-login-text">ç«‹å³ç™»å½•</text>
    </view>
  </view>
</view>

<!-- å·²ç™»å½•çŠ¶æ€æ˜¾ç¤ºæ¶ˆæ¯åˆ—è¡¨ -->
<view wx:else class="page-container">
  <view class="filter-section">
    <view class="filter-header">
      <scroll-view scroll-x class="filter-scroll-view" show-scrollbar="false">
        <view class="filter-tabs">
          <block wx:for="{{filters}}" wx:key="key" wx:for-item="item">
            <view class="filter-tab {{item.active ? 'filter-tab--active' : ''}}" bindtap="onFilterTap" data-key="{{item.key}}">
              {{item.name}}
            </view>
          </block>
        </view>
      </scroll-view>
      <view class="mark-all-btn" bindtap="markAllRead">
        <text class="icon">âœ“</text>
        <text>å…¨éƒ¨å·²è¯»</text>
      </view>
    </view>
  </view>

  <view class="content-section">
    <block wx:for="{{messages}}" wx:key="id">
      <view class="message-card card shadow-card" bindtap="onMessageTap" data-id="{{item.id}}" data-activity-id="{{item.activityId}}">
        <view class="row gap-16 items-start">
          <view class="message-icon" style="background: {{item.iconBg}}; color: {{item.iconColor}};">{{item.iconText}}</view>
          <view class="flex-col message-body">
            <view class="row-between mb-8">
              <text class="text-md text-gray-800">{{item.title}}</text>
              <text class="text-xs">{{item.time}}</text>
            </view>
            <text class="text-sm">{{item.content}}</text>
            <view class="row gap-12 mt-16">
              <block wx:for="{{item.tags}}" wx:for-item="tag" wx:key="name">
                <view class="badge" style="background: {{tag.bg}}; color: {{tag.color}};">{{tag.name}}</view>
              </block>
            </view>
          </view>
        </view>
      </view>
    </block>
  </view>

  <view class="bottom-space"></view>
</view>
